# 좌표계 및 항력 방향 검증 리포트

## 검증 날짜

2026년 1월 6일

## 검증 목적

MLB Statcast 좌표계에서 물리 엔진의 항력 방향이 올바르게 구현되었는지 확인

## 좌표계 정의

### MLB Statcast 좌표계

- **원점**: 홈플레이트 (포수 위치)
- **+y 축**: 홈플레이트 → 투수판 방향
- **+z 축**: 수직 상향
- **+x 축**: 1루 → 3루 방향

### 중요한 물리적 특성

1. 투수가 공을 던질 때: **vy < 0** (홈플레이트 방향으로)
2. 항력은 속도의 반대 방향: **vy < 0 → Fy > 0**
3. 만약 부호가 반대라면: 공이 가속되어 "로켓 효과" 발생

## 검증 결과

### ✅ Test 1: 기본 항력 방향 검증

**초기 조건:**

```
위치: (0.00, 18.44, 1.83) m  [투수판 위치]
속도: (0.00, -42.50, 0.00) m/s  [홈플레이트 방향]
회전: 없음 (순수 항력만 테스트)
```

**계산된 힘:**

```
Fx =  0.0000 N  (측면)
Fy = +0.0436 N  (전후)
Fz = -1.4220 N  (수직, 중력 포함)
```

**검증:**

- ✅ **vy = -42.50 m/s** (음수, 홈플레이트 방향)
- ✅ **Fy = +0.0436 N** (양수, 투수판 방향)
- ✅ **결론**: 항력이 속도의 반대 방향! 공이 정상적으로 감속됨

### ✅ Test 2: 다양한 속도 방향에 대한 검증

모든 방향에서 항력과 속도의 내적이 음수인지 확인:

| 방향            | 속도 (m/s)  | 항력 (N)       | 내적  | 결과 |
| --------------- | ----------- | -------------- | ----- | ---- |
| 홈플레이트 (-y) | (0, -40, 0) | (0, +0.041, 0) | -1.64 | ✅   |
| 투수판 (+y)     | (0, +40, 0) | (0, -0.041, 0) | -1.64 | ✅   |
| 3루 (-x)        | (-40, 0, 0) | (+0.041, 0, 0) | -1.64 | ✅   |
| 1루 (+x)        | (+40, 0, 0) | (-0.041, 0, 0) | -1.64 | ✅   |
| 상승 (+z)       | (0, 0, +40) | (0, 0, -0.041) | -1.64 | ✅   |
| 하강 (-z)       | (0, 0, -40) | (0, 0, +0.041) | -1.64 | ✅   |

**결론**: 모든 방향에서 항력이 속도의 반대 방향으로 작용함

### ✅ Test 3: 실제 투구 시뮬레이션

**조건**: 95mph Fastball with 2400 RPM backspin

**시간별 추적 (0.1초 간격):**

```
시간    y위치      vy속도      Fy힘        상태
0.00s   18.44m    -42.50m/s   +0.0448N   ✓ 감속
0.10s   14.19m    -42.47m/s   +0.0454N   ✓ 감속
0.20s    9.95m    -42.44m/s   +0.0460N   ✓ 감속
0.30s    5.71m    -42.41m/s   +0.0466N   ✓ 감속
0.40s    1.47m    -42.37m/s   +0.0472N   ✓ 감속
```

**관찰 결과:**

1. vy는 계속 음수를 유지 (홈플레이트 방향)
2. Fy는 계속 양수를 유지 (항력이 감속 방향)
3. 속도 크기가 점진적으로 감소 (42.50 → 42.34 m/s)
4. ✅ **정상 동작 확인**

## 코드 검증

### 항력 계산 로직 (savant_physics.py Line 271)

```python
# 2. Drag Force: F_d = -0.5 * ρ * A * C_D * |v| * v
drag_magnitude = 0.5 * self.rho * self.area * c_d.unsqueeze(-1) * v_mag
f_drag = -drag_magnitude * velocity / (v_mag + 1e-6)
```

**수학적 검증:**

- velocity = (0, -42.5, 0)
- v_mag = 42.5
- drag_magnitude = 0.5 × ρ × A × C_D × 42.5 > 0
- f_drag = -drag_magnitude × velocity / v_mag
- f_drag_y = -drag_magnitude × (-42.5) / 42.5 = +drag_magnitude > 0 ✅

**결론**: 공식이 올바르게 구현됨

## 최종 결론

### ✅ 검증 통과

1. **좌표계 구현**: MLB Statcast 좌표계가 올바르게 구현됨
2. **항력 방향**: 모든 경우에서 속도의 반대 방향으로 작용
3. **물리적 타당성**: 공이 던질수록 감속됨 (로켓 효과 없음)
4. **코드 정확성**: 수학적 공식이 올바르게 구현됨

### 권고사항

**현재 코드는 수정 불필요**

- 항력 방향이 올바르게 구현되어 있습니다
- vy < 0 → Fy > 0 관계가 정확히 유지됩니다
- 물리적으로 타당한 시뮬레이션이 실행됩니다

## 추가 검증 방법

향후 다음 방법으로 추가 검증 가능:

1. **실제 Statcast 데이터와 비교**

   - MLB 실측 궤적과 시뮬레이션 비교
   - 비행 거리/시간 검증

2. **극한 조건 테스트**

   - 초고속 투구 (110+ mph)
   - 극단적 회전 (3000+ RPM)
   - 다양한 환경 조건

3. **에너지 보존 확인**
   - 운동 에너지가 시간에 따라 감소하는지 확인
   - 비물리적 에너지 증가가 없는지 검증

---

**작성자**: Aegis Physics Engine Team
**검증 환경**: Python 3.14, PyTorch 2.9.1
**테스트 스크립트**: `tests/test_coordinate_system.py`
